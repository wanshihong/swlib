{% extends "devtool/layout.twig" %}

{% block content %}
<div class="devtool-doc">
    <h1>Proto æ‰©å±•ç¼–è¾‘å™¨</h1>

    <div class="doc-section">
        <h3>ğŸ“‹ å·¥å…·è¯´æ˜</h3>
        <p>
            æœ¬æ¡†æ¶é‡‡ç”¨ <strong>Protobuf é©±åŠ¨</strong>ï¼Œè‡ªåŠ¨å°†æ•°æ®åº“è¡¨ç»“æ„è½¬æ¢ä¸º Proto æ¶ˆæ¯å®šä¹‰ã€‚
            åŸºç¡€å­—æ®µç›´æ¥æ¥è‡ªæ•°æ®åº“è¡¨çš„åˆ—å®šä¹‰ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚
        </p>
        <p>
            å½“å‰ç«¯äº¤äº’éœ€æ±‚è¶…å‡ºæ•°æ®åº“è¡¨ç»“æ„èŒƒå›´ï¼Œä¸”ä¸ä¾¿æ·»åŠ æ–°æ•°æ®åº“å­—æ®µæ—¶ï¼Œ
            å¯ä½¿ç”¨æœ¬å·¥å…·å¯¹ Proto æ¶ˆæ¯è¿›è¡Œ <strong>å­—æ®µæ‰©å±•</strong>ï¼Œçµæ´»æ»¡è¶³ä¸šåŠ¡éœ€æ±‚ã€‚
        </p>
    </div>

    <div class="doc-section">
        <h3>ğŸ¯ ä½¿ç”¨åœºæ™¯</h3>
        <ul>
            <li><strong>è®¡ç®—å­—æ®µï¼š</strong> æ·»åŠ ç”±å…¶ä»–å­—æ®µæ´¾ç”Ÿçš„è™šæ‹Ÿå­—æ®µï¼ˆå¦‚ <code>age</code> ç”± <code>birth_date</code> è®¡ç®—ï¼‰</li>
            <li><strong>å…³è”æ•°æ®ï¼š</strong> åµŒå…¥å…³è”è¡¨çš„æ•°æ®è€Œæ— éœ€ä¿®æ”¹æ•°æ®åº“ç»“æ„</li>
            <li><strong>ä¸šåŠ¡æ‰©å±•ï¼š</strong> ä¸´æ—¶æ·»åŠ å‰ç«¯æ‰€éœ€çš„é¢å¤–å­—æ®µï¼Œæ— éœ€æ•°æ®åº“è¿ç§»</li>
            <li><strong>å…¼å®¹æ€§ï¼š</strong> ä¸ºæ—§ç‰ˆæœ¬ API è¡¥å……æ–°å­—æ®µï¼Œä¿æŒå‘åå…¼å®¹</li>
        </ul>
    </div>

    <div class="doc-section">
        <h3>âš™ï¸ å·¥ä½œåŸç†</h3>
        <p>
            æ‰©å±•å­—æ®µé…ç½®å­˜å‚¨åœ¨æ•°æ®åº“è¡¨çš„ <code>id</code> åˆ—æ³¨é‡Šä¸­ï¼Œæ ¼å¼ä¸º JSON æ•°ç»„ï¼š
        </p>
        <pre><code>protobuf:ext:json:["ä½ç½®:å­—æ®µå:å­—æ®µç±»å‹", ...]</code></pre>
        <p>
            <strong>ä½ç½®ï¼š</strong> <code>item</code>ï¼ˆå•æ¡è®°å½•ï¼‰æˆ– <code>lists</code>ï¼ˆåˆ—è¡¨è®°å½•ï¼‰<br>
            <strong>å­—æ®µç±»å‹ï¼š</strong> æ”¯æŒåŸºç¡€ç±»å‹ï¼ˆ<code>int32</code>ã€<code>string</code> ç­‰ï¼‰ã€
            <code>$self</code>ï¼ˆè‡ªå¼•ç”¨ï¼‰ã€å…¶ä»– Proto æ¶ˆæ¯ç±»å‹ï¼Œä»¥åŠ <code>repeated</code> å˜ä½“
        </p>
    </div>

    <div class="doc-section">
        <h3>ğŸ“ å¿«é€Ÿå¼€å§‹</h3>
        <p>
            ä¸‹æ–¹é€‰æ‹©è¦æ‰©å±•çš„æ•°æ®åº“å’Œè¡¨ï¼Œç‚¹å‡»"ç¼–è¾‘æ‰©å±•"å³å¯æ·»åŠ æˆ–ä¿®æ”¹ Proto å­—æ®µã€‚
            æ‰€æœ‰ä¿®æ”¹å®æ—¶ä¿å­˜åˆ°æ•°æ®åº“è¡¨æ³¨é‡Šï¼Œç”Ÿæˆå™¨ä¸‹æ¬¡è¿è¡Œæ—¶è‡ªåŠ¨åº”ç”¨ã€‚
        </p>
    </div>
</div>

<h2>é€‰æ‹©è¡¨æ ¼è¿›è¡Œæ‰©å±•</h2>

<div class="search-row">
    <label for="table-search">æœç´¢è¡¨åï¼š</label>
    <input type="text" id="table-search" placeholder="è¾“å…¥è¡¨åå…³é”®å­—è‡ªåŠ¨è¿‡æ»¤">
</div>

{% for dbName, tables in dbTables %}
    <h2>æ•°æ®åº“: {{ dbName }}</h2>
    <ul class="table-list" data-db="{{ dbName }}">
        {% for table in tables %}
            <li data-table-name="{{ table }}">
                {{ table }} -
                <a href="/dev-tool/protobuf-ext-editor/edit?db={{ dbName|url_encode }}&table={{ table|url_encode }}">ç¼–è¾‘æ‰©å±•</a>
            </li>
        {% endfor %}
    </ul>
{% endfor %}

<script>
    (function () {
        var input = document.getElementById('table-search');
        if (!input) return;

        input.addEventListener('input', function () {
            var keyword = this.value.toLowerCase();
            var lists = document.querySelectorAll('ul.table-list');

            lists.forEach(function (ul) {
                var hasVisible = false;
                ul.querySelectorAll('li[data-table-name]').forEach(function (li) {
                    var name = (li.getAttribute('data-table-name') || '').toLowerCase();
                    var match = !keyword || name.indexOf(keyword) !== -1;
                    li.style.display = match ? '' : 'none';
                    if (match) {
                        hasVisible = true;
                    }
                });

                var prev = ul.previousElementSibling;
                while (prev && prev.tagName !== 'H2') {
                    prev = prev.previousElementSibling;
                }
                if (prev && prev.tagName === 'H2') {
                    prev.style.display = hasVisible ? '' : 'none';
                }
            });
        });
    })();
</script>

{% endblock %}

